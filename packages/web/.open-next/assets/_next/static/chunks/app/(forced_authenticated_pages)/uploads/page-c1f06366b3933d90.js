(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[659],{7869:function(t,e,r){Promise.resolve().then(r.bind(r,1592))},6039:function(t,e,r){"use strict";r(3132)},4835:function(t,e,r){"use strict";r.d(e,{c:function(){return c}});var n=r(3132),o=r.n(n);r(6039);var s=r(9306);let a=async()=>{let t=await (0,s.ag)({path:"presigned"});if(console.log("response",t),200!==t.status)throw Error("Failed to get pre-signed URL");let e=await t.data.url;return{url:e,key:t.data.key,user:t.data.user,id:t.data.id}};async function c(t){let{file:e}=t;console.log(e);let r=await a();return console.log(r),o().put("".concat(r.url),e.current,{headers:{"Content-Type":e.current.type,"Content-Disposition":'attachment; filename="'.concat(e.current.name,'"')}}).then(t=>{if(console.log("response",t),200===t.status)return{data:{response:"success",key:r.key,user:r.user,id:r.id},status:200,statusText:"OK",headers:{},config:{}};throw Error("An error occurred: ".concat(t.statusText))})}},5168:function(t,e,r){"use strict";function n(){if(void 0===window.location)return null;let t=new URL("http://localhost:3000"),e=t.protocol+"//",r=t.hostname,n=t.port?":".concat(t.port):"",o=window.location.protocol+"//",s=window.location.hostname,a=window.location.port?":".concat(window.location.port):"",c="localhost"===s?e:o,u="localhost"===s?r:s,i=""===a&&"localhost"!==s?"":a||n;return"".concat(c).concat(u).concat(i)}r.d(e,{$:function(){return n}})},1756:function(t,e){"use strict";e.Z=t=>{throw console.error("An error occurred:",t),Error("An error occurred.")}},9306:function(t,e,r){"use strict";r.d(e,{F9:function(){return u},O8:function(){return i},ag:function(){return c}});var n=r(3132),o=r.n(n),s=r(1756),a=r(5168);async function c(t){let{path:e}=t,r=(0,a.$)();return o().get("".concat(r,"/api/tunnel/").concat(e),{}).then(t=>{if(200===t.status)return console.log("get returned response",t),{data:t.data.response,status:t.status};throw(0,s.Z)({message:t.statusText}),Error(t.statusText)}).catch(t=>{throw(0,s.Z)({error:t}),t})}async function u(t){let{path:e,data:r,additionalHeaders:n={}}=t,c=(0,a.$)();return o().post("".concat(c,"/api/tunnel/").concat(e),r,{}).then(t=>{if(200===t.status)return console.log("post returned response",t),{data:t.data.response,status:t.status};throw(0,s.Z)({message:t.statusText}),Error(t.statusText)}).catch(t=>{throw(0,s.Z)({error:t}),t})}async function i(t){let{path:e}=t,r=(0,a.$)();return o().delete("".concat(r,"/api/tunnel/").concat(e)).then(t=>{if(200===t.status)return{data:t.data.response,status:t.status};throw(0,s.Z)({message:t.statusText}),Error(t.statusText)}).catch(t=>{throw(0,s.Z)({error:t}),t})}},1592:function(t,e,r){"use strict";r.r(e);var n=r(4618);r(7024);var o=r(4835),s=r(4540);e.default=function(){return(0,s.useSession)(),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold",children:"How to upload files to S3"}),(0,n.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{var e;let r=null===(e=t.target.file.files)||void 0===e?void 0:e[0];if(!r){console.error("File not selected.");return}let n=await (0,o.c)({file:r});if(200!==n.status){console.error("Upload failed with status: ".concat(n.status));return}if(!n.config.url){console.error("Upload failed, no URL returned.");return}window.location.href=n.config.url.split("?")[0]}catch(t){console.error("An error occurred: ".concat(t))}},children:[(0,n.jsx)("input",{name:"file",type:"file",accept:"image/png, image/jpeg"}),(0,n.jsx)("button",{type:"submit",children:"Upload"})]})]})})}}},function(t){t.O(0,[540,132,89,676,744],function(){return t(t.s=7869)}),_N_E=t.O()}]);